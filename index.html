<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>cozy-owl-shoehaven</title>
    <meta name="description" content="Lovable Generated Project" />
    <meta name="author" content="Lovable" />
    <meta property="og:image" content="/og-image.png" />
    <script defer src="https://media.twiliocdn.com/sdk/js/webchat-v3/releases/3.1.0/webchat.min.js" integrity="sha256-nJWyi7NAblODdGxT61sd1TDkeCJl+eRXbsnOKITfrS4=" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="root"></div>
    <div id="twilio-webchat-widget-root"></div>
    <script src="https://cdn.gpteng.co/gptengineer.js" type="module"></script>
    <script type="module" src="/src/main.tsx"></script>
    <script>
      window.addEventListener("load", async () => {
        try {
          const response = await fetch('https://udkrelrxlvpysiszrezw.supabase.co/functions/v1/twilio-token', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            }
          });
          
          const data = await response.json();
          
          if (data.error) {
            console.error('Error initializing Twilio chat:', data.error);
            return;
          }

          const appConfig = {
            accountSid: data.accountSid,
            flexFlowSid: data.flexFlowSid,
            context: data.context,
            deploymentKey: "CV27a8670335f1edc5e1e0a05a61abb6d2"
          };

          Twilio.initWebchat(appConfig);
        } catch (error) {
          console.error('Error initializing chat:', error);
        }
      });
    </script>
  </body>
</html>